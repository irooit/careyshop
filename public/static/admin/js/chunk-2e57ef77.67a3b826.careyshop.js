(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e57ef77"],{2848:function(t,e,a){"use strict";var s=a("3ca1"),i=a.n(s);i.a},"3ca1":function(t,e,a){},a9d4:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cs-p"},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"box-card-header",attrs:{slot:"header"},slot:"header"},[a("el-row",{staticClass:"cs-mb-10"},[a("el-col",{attrs:{span:18}},[a("span",{staticClass:"text-explode"},[t._v("商品：")]),a("span",{staticClass:"link",on:{click:function(e){return t.handleView(t.tableData.get_order_goods.goods_id)}}},[t._v(t._s(t.tableData.get_order_goods.goods_name))])]),a("el-col",{attrs:{span:6}},[a("el-rate",{attrs:{disabled:!0,colors:["#99A9BF","#F7BA2A","#FF9900"]},model:{value:t.tableData.score,callback:function(e){t.$set(t.tableData,"score",e)},expression:"tableData.score"}})],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"text-explode"},[t._v("规格：")]),a("span",[t._v(t._s(t.tableData.get_order_goods.key_value))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"text-explode"},[t._v("订单号：")]),a("span",{staticClass:"link",on:{click:function(e){return t.handleOrder(t.tableData.order_no)}}},[t._v(t._s(t.tableData.order_no))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"text-explode"},[t._v("状态：")]),null!==t.tableData.status?a("el-tag",{attrs:{type:t.statusMap[t.tableData.status].type,effect:"plain",size:"mini"}},[t._v(" "+t._s(t.statusMap[t.tableData.status].text)+" ")]):t._e()],1)],1)],1),a("el-timeline",[a("el-timeline-item",{attrs:{timestamp:"[主评] "+t.tableData.create_time,type:"primary",placement:"top"}},[a("el-card",{staticClass:"action",attrs:{shadow:"never"}},[a("div",{staticClass:"user-icon"},[a("el-avatar",{attrs:{size:"medium",src:t._f("getPreviewUrl")(t.tableData.get_user.head_pic,"head_pic")}},[a("img",{attrs:{src:t.$publicPath+"image/setting/user.png",alt:""}})])],1),a("div",{staticClass:"problem"},[a("div",{staticClass:"consult-content cs-pb-10"},[a("span",{class:{"no-content":!t.tableData.content}},[t._v(t._s(t.tableData.content||"无评价内容"))]),a("el-button",{staticClass:"form-button active",attrs:{type:"text",size:"small"},on:{click:function(e){return t.initReplyForm(t.tableData.goods_comment_id)}}},[t._v("回复")])],1),a("div",{staticStyle:{"line-height":"0"}},t._l(t.tableData.image,(function(e,s){return a("el-image",{key:s,staticClass:"comment_thumb",attrs:{src:t._f("getPreviewUrl")(e,"comment_thumb_x40"),lazy:!0,fit:"cover"},on:{click:function(e){return e.stopPropagation(),t.$preview(t.tableData.image,s)}}})})),1),a("div",{staticClass:"user-name"},[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("span",[t._v(t._s(t.tableData.ip_address_region))]),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(t.tableData.get_user.username))])]),t.tableData.get_user.level_icon?a("el-image",{staticClass:"level-icon",attrs:{src:t.tableData.get_user.level_icon,fit:"fill"}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]):t._e()],1)])])],1),t._l(t.tableData.get_main_reply,(function(e,s){return a("el-timeline-item",{key:"main_reply"+s,attrs:{timestamp:"[主评回复] "+e.create_time,type:"danger",placement:"top"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"user-icon"},[a("el-avatar",{attrs:{size:"medium",src:t.$publicPath+"image/setting/admin.png"}})],1),a("div",{staticClass:"problem"},[a("div",{staticClass:"consult-content cs-pb-10"},[t._v(t._s(e.content))]),a("div",{staticStyle:{"line-height":"0"}},t._l(e.image,(function(s,i){return a("el-image",{key:i,staticClass:"comment_thumb",attrs:{src:t._f("getPreviewUrl")(s,"comment_thumb_x40"),lazy:!0,fit:"cover"},on:{click:function(a){return a.stopPropagation(),t.$preview(e.image,i)}}})})),1),a("div",{staticClass:"user-name"},[a("span",[t._v("客服人员")])])])])],1)})),t.tableData.get_addition?a("el-timeline-item",{attrs:{timestamp:"[追评] "+t.tableData.get_addition.create_time,type:"primary",placement:"top"}},[a("el-card",{staticClass:"action",attrs:{shadow:"never"}},[a("div",{staticClass:"user-icon"},[a("el-avatar",{attrs:{size:"medium",src:t._f("getPreviewUrl")(t.tableData.get_user.head_pic,"head_pic")}},[a("img",{attrs:{src:t.$publicPath+"image/setting/user.png",alt:""}})])],1),a("div",{staticClass:"problem"},[a("div",{staticClass:"consult-content cs-pb-10"},[a("span",[t._v(t._s(t.tableData.get_addition.content))]),a("el-button",{staticClass:"form-button active",attrs:{type:"text",size:"small"},on:{click:function(e){return t.initReplyForm(t.tableData.get_addition.goods_comment_id)}}},[t._v("回复")])],1),a("div",{staticStyle:{"line-height":"0"}},t._l(t.tableData.get_addition.image,(function(e,s){return a("el-image",{key:s,staticClass:"comment_thumb",attrs:{src:t._f("getPreviewUrl")(e,"comment_thumb_x40"),lazy:!0,fit:"cover"},on:{click:function(e){return e.stopPropagation(),t.$preview(t.tableData.get_addition.image,s)}}})})),1),a("div",{staticClass:"user-name"},[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("span",[t._v(t._s(t.tableData.get_addition.ip_address_region))]),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(t.tableData.get_user.username))])]),t.tableData.get_user.level_icon?a("el-image",{staticClass:"level-icon",attrs:{src:t.tableData.get_user.level_icon,fit:"fill"}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]):t._e()],1)])])],1):t._e(),t._l(t.tableData.get_addition_reply,(function(e,s){return a("el-timeline-item",{key:"addition_reply"+s,attrs:{timestamp:"[追评回复] "+e.create_time,type:"danger",placement:"top"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"user-icon"},[a("el-avatar",{attrs:{size:"medium",src:t.$publicPath+"image/setting/admin.png"}})],1),a("div",{staticClass:"problem"},[a("div",{staticClass:"consult-content cs-pb-10"},[t._v(t._s(e.content))]),a("div",{staticStyle:{"line-height":"0"}},t._l(e.image,(function(s,i){return a("el-image",{key:i,staticClass:"comment_thumb",attrs:{src:t._f("getPreviewUrl")(s,"comment_thumb_x40"),lazy:!0,fit:"cover"},on:{click:function(a){return a.stopPropagation(),t.$preview(e.image,i)}}})})),1),a("div",{staticClass:"user-name"},[a("span",[t._v("客服人员")])])])])],1)}))],2),a("el-form",{directives:[{name:"permission",rawName:"v-permission",value:"/goods/opinion/comment/detail",expression:"'/goods/opinion/comment/detail'"}],ref:"form",attrs:{model:t.form,rules:t.rules,id:"reply-form","label-width":"68px"}},[t.form.isShowReply?a("el-form-item",{attrs:{prop:"content"}},[a("el-input",{attrs:{placeholder:"请输入回复内容",type:"textarea",autosize:{minRows:5},"show-word-limit":!0,maxlength:"200"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}}),a("div",{staticStyle:{"line-height":"0"}},t._l(t.form.image,(function(e,s){return a("el-image",{key:s,staticClass:"comment_thumb",staticStyle:{margin:"10px 5px 0 0"},attrs:{src:t._f("getPreviewUrl")(e,"comment_thumb_x40"),lazy:!0,fit:"cover"},on:{click:function(e){return e.stopPropagation(),t.$preview(t.form.image,s)}}})})),1),a("div",{staticClass:"cs-mt-10"},[a("el-dropdown",{attrs:{"show-timeout":50,placement:"bottom"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"cs-mr-10",attrs:{type:"info",size:"small"}},[a("span",[t._v("上传图片")]),a("i",{staticClass:"el-icon-arrow-down cs-pl-5"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"storage",icon:"el-icon-finished"}},[t._v("资源选择")]),a("el-dropdown-item",{attrs:{command:"upload",icon:"el-icon-upload2"}},[t._v("上传资源")])],1)],1),a("el-button",{attrs:{type:"primary",loading:t.submitLoading,size:"small"},on:{click:t.handleFormSubmit}},[t._v("提交")])],1)],1):t._e(),a("cs-storage",{ref:"storage",staticStyle:{display:"none"},on:{confirm:t._getStorageFileList}}),a("cs-upload",{ref:"upload",staticStyle:{display:"none"},attrs:{type:"slot",accept:"image/*"},on:{confirm:t._getUploadFileList}})],1)],1)],1)},i=[],r=(a("4160"),a("b0c0"),a("d3b7"),a("159b"),a("b85c")),o=a("ca00"),n=a("f663"),l={components:{csUpload:function(){return a.e("chunk-0383e8e2").then(a.bind(null,"8422"))},csStorage:function(){return a.e("chunk-7557cd56").then(a.bind(null,"8704"))}},props:{tableData:{default:function(){return[]}}},data:function(){return{form:{},formBuffer:{},submitLoading:!1,srcList:[null],rules:{content:[{required:!0,message:"回复内容不能为空",trigger:"blur"},{max:200,message:"长度不能大于 200 个字符",trigger:"blur"}]},statusMap:{0:{text:"待处理",type:"warning"},1:{text:"已处理",type:"success"}}}},filters:{getPreviewUrl:function(t,e){return t&&(t.source||t)?o["a"].getImageCodeUrl(t.source||t,e):""}},watch:{"tableData.goods_comment_id":{handler:function(t){var e=this;t>0&&(this.formBuffer[t]?this.form=this.formBuffer[t]||{}:(this.formBuffer[t]={goods_comment_id:void 0,content:void 0,image:void 0,isShowReply:!1},this.form=this.formBuffer[t]),this.$nextTick((function(){e.$refs.form&&e.$refs.form.clearValidate()})))}}},methods:{handleCommand:function(t){switch(t){case"storage":this.$refs.storage.handleStorageDlg([0,2]);break;case"upload":this.$refs.upload.handleUploadDlg();break}},_getUploadFileList:function(t){var e,a=[],s=Object(r["a"])(t);try{for(s.s();!(e=s.n()).done;){var i=e.value;if("success"===i.status){var o=i.response;o&&200===o.status&&o.data&&0===o.data[0].type&&a.push({name:o.data[0].name,source:o.data[0].url})}}}catch(n){s.e(n)}finally{s.f()}this.form.image=a},_getStorageFileList:function(t){var e=[];t.forEach((function(t){0===t.type&&e.push({name:t.name,source:t.url})})),this.form.image=e},initReplyForm:function(t){var e=this;this.form.goods_comment_id=t,this.form.content="",this.form.image=[],this.form.isShowReply=!0,this.$nextTick((function(){e.$refs.form&&e.$refs.form.clearValidate();var t=e.$el.querySelector("#reply-form");e.$parent.scrollTo(0,t.offsetTop)}))},handleFormSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.submitLoading=!0;var a=t.tableData.goods_comment_id;Object(n["d"])(t.form).then((function(e){t.form.isShowReply=!1,t.$emit("reply",a,e.data),t.$message.success("操作成功")})).finally((function(){t.submitLoading=!1}))}}))},handleView:function(t){this.$router.push({name:"goods-admin-view",params:{goods_id:t}})},handleOrder:function(t){this.$router.push({name:"order-admin-info",params:{order_no:t}})}}},c=l,m=(a("2848"),a("2877")),d=Object(m["a"])(c,s,i,!1,null,"1f495ff2",null);e["default"]=d.exports}}]);