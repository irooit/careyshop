(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03f21670"],{"0aaa":function(e,t,o){"use strict";var a=o("2109"),n=o.n(a);n.a},2109:function(e,t,o){},"707d":function(e,t,o){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function a(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function l(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}s((a=a.apply(e,t||[])).next())}))}function n(e,t){var o,a,n,i,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!((n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){r.label=i[1];break}if(6===i[0]&&r.label<n[1]){r.label=n[1],n=i;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(i);break}n[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}o.d(t,"a",(function(){return D}));var i=function(e){};function r(e){i(e)}(function(){(console.warn||console.log).apply(console,arguments)}).bind("[clipboard-polyfill]");var l,s,c,d,u="undefined"==typeof navigator?void 0:navigator,f=null==u?void 0:u.clipboard,p=(null===(l=null==f?void 0:f.read)||void 0===l||l.bind(f),null===(s=null==f?void 0:f.readText)||void 0===s||s.bind(f),null===(c=null==f?void 0:f.write)||void 0===c||c.bind(f),null===(d=null==f?void 0:f.writeText)||void 0===d?void 0:d.bind(f)),m="undefined"==typeof window?void 0:window,g=(null==m||m.ClipboardItem,m);function h(){return"undefined"==typeof ClipboardEvent&&void 0!==g.clipboardData&&void 0!==g.clipboardData.setData}var b=function(){this.success=!1};function v(e,t,o){for(var a in r("listener called"),e.success=!0,t){var n=t[a],i=o.clipboardData;i.setData(a,n),"text/plain"===a&&i.getData(a)!==n&&(r("setting text/plain failed"),e.success=!1)}o.preventDefault()}function x(e){var t=new b,o=v.bind(this,t,e);document.addEventListener("copy",o);try{document.execCommand("copy")}finally{document.removeEventListener("copy",o)}return t.success}function y(e,t){w(e);var o=x(t);return _(),o}function w(e){var t=document.getSelection();if(t){var o=document.createRange();o.selectNodeContents(e),t.removeAllRanges(),t.addRange(o)}}function _(){var e=document.getSelection();e&&e.removeAllRanges()}function k(e){return a(this,void 0,void 0,(function(){var t;return n(this,(function(o){if(t="text/plain"in e,h()){if(!t)throw new Error("No `text/plain` value was specified.");if(a=e["text/plain"],g.clipboardData.setData("Text",a))return[2,!0];throw new Error("Copying failed, possibly because the user rejected it.")}var a;return x(e)?(r("regular execCopy worked"),[2,!0]):navigator.userAgent.indexOf("Edge")>-1?(r('UA "Edge" => assuming success'),[2,!0]):y(document.body,e)?(r("copyUsingTempSelection worked"),[2,!0]):function(e){var t=document.createElement("div");t.setAttribute("style","-webkit-user-select: text !important"),t.textContent="temporary element",document.body.appendChild(t);var o=y(t,e);return document.body.removeChild(t),o}(e)?(r("copyUsingTempElem worked"),[2,!0]):function(e){r("copyTextUsingDOM");var t=document.createElement("div");t.setAttribute("style","-webkit-user-select: text !important");var o=t;t.attachShadow&&(r("Using shadow DOM."),o=t.attachShadow({mode:"open"}));var a=document.createElement("span");a.innerText=e,o.appendChild(a),document.body.appendChild(t),w(a);var n=document.execCommand("copy");return _(),document.body.removeChild(t),n}(e["text/plain"])?(r("copyTextUsingDOM worked"),[2,!0]):[2,!1]}))}))}function D(e){return a(this,void 0,void 0,(function(){return n(this,(function(t){if(p)return r("Using `navigator.clipboard.writeText()`."),[2,p(e)];if(!k(function(e){var t={};return t["text/plain"]=e,t}(e)))throw new Error("writeText() failed");return[2]}))}))}(function(){function e(e,t){var o;for(var a in void 0===t&&(t={}),this.types=Object.keys(e),this._items={},e){var n=e[a];this._items[a]="string"==typeof n?$(a,n):n}this.presentationStyle=null!==(o=null==t?void 0:t.presentationStyle)&&void 0!==o?o:"unspecified"}e.prototype.getType=function(e){return a(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this._items[e]]}))}))}})();function $(e,t){return new Blob([t],{type:e})}},"85ae":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"cs-p"},[o("el-form",{attrs:{inline:!0,size:"small"}},[e.auth.add?o("el-form-item",[o("el-button",{attrs:{icon:"el-icon-plus",disabled:e.loading},on:{click:e.handleCreate}},[e._v("新增二维码")])],1):e._e(),e.auth.del?o("el-form-item",[o("el-button",{attrs:{icon:"el-icon-delete",disabled:e.loading},on:{click:function(t){return e.handleDelete(null)}}},[e._v("删除")])],1):e._e(),o("cs-help",{staticStyle:{"padding-bottom":"19px"},attrs:{router:e.$route.path}})],1),o("el-table",{attrs:{data:e.currentTableData,"highlight-current-row":!0},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),o("el-table-column",{attrs:{label:"名称",prop:"name","min-width":"180"}}),o("el-table-column",{attrs:{label:"内容",prop:"text","min-width":"220","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"Logo",prop:"logo",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.logo?o("el-popover",{attrs:{width:"150",placement:"top",trigger:"hover"}},[o("div",{staticClass:"popover-image"},[o("el-image",{attrs:{src:t.row.logo,fit:"fill"},on:{click:function(o){return o.stopPropagation(),e.$preview(t.row.logo)}}})],1),o("i",{staticClass:"el-icon-picture",attrs:{slot:"reference"},slot:"reference"})]):e._e()]}}])}),o("el-table-column",{attrs:{label:"尺寸",prop:"size"}}),o("el-table-column",{attrs:{label:"后缀",prop:"suffix"}}),o("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.auth.view?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){return e.handleView(t.$index)}}},[e._v("详细")]):e._e(),e.auth.set?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){return e.handleUpdate(t.$index)}}},[e._v("编辑")]):e._e(),e.auth.del?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){return e.handleDelete(t.$index)}}},[e._v("删除")]):e._e()]}}])})],1),o("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入二维码名称",clearable:!0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"内容",prop:"text"}},[o("el-input",{attrs:{placeholder:"请输入二维码内容",type:"textarea",rows:3},model:{value:e.form.text,callback:function(t){e.$set(e.form,"text",t)},expression:"form.text"}})],1),o("el-form-item",{attrs:{label:"Logo",prop:"logo"}},[o("el-input",{attrs:{placeholder:"可输入二维码Logo链接",clearable:!0},model:{value:e.form.logo,callback:function(t){e.$set(e.form,"logo",t)},expression:"form.logo"}},[o("el-dropdown",{attrs:{slot:"append","show-timeout":50},on:{command:e.handleCommand},slot:"append"},[o("el-button",{attrs:{icon:"el-icon-upload"}}),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"storage",icon:"el-icon-finished"}},[e._v("资源选择")]),o("el-dropdown-item",{attrs:{command:"upload",icon:"el-icon-upload2"}},[e._v("上传资源")])],1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"尺寸",prop:"size"}},[o("el-input-number",{attrs:{"controls-position":"right",min:50,max:65535,step:10},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"后缀",prop:"suffix"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.suffix,callback:function(t){e.$set(e.form,"suffix",t)},expression:"form.suffix"}},[o("el-option",{attrs:{label:"png",value:"png"}}),o("el-option",{attrs:{label:"jpg",value:"jpg"}}),o("el-option",{attrs:{label:"gif",value:"gif"}})],1)],1)],1)],1)],1),o("el-divider",[e._v("效果预览")]),e.form.text?o("div",{staticClass:"cs-tc"},[e.qrcodeImage?o("el-image",{attrs:{fit:"fill",src:e.qrcodeImage}}):e._e()],1):e._e(),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),"create"===e.dialogStatus?o("el-button",{attrs:{type:"primary",loading:e.dialogLoading,size:"small"},on:{click:e.create}},[e._v("确定")]):o("el-button",{attrs:{type:"primary",loading:e.dialogLoading,size:"small"},on:{click:e.update}},[e._v("修改")])],1),o("cs-storage",{ref:"storage",staticStyle:{display:"none"},attrs:{limit:1},on:{confirm:e._getStorageFileList}}),o("cs-upload",{ref:"upload",staticStyle:{display:"none"},attrs:{type:"slot",accept:"image/*",limit:1,multiple:!1},on:{confirm:e._getUploadFileList}})],1),o("el-dialog",{attrs:{title:"二维码预览",visible:e.dialogQrcodeVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogQrcodeVisible=t}}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[e._v("效果预览")])]),o("el-col",{attrs:{span:20}},[e.qrcodeData.url?o("el-image",{attrs:{fit:"fill",src:e.qrcodeData.url+"&t="+Math.random()}}):e._e()],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[e._v("名称")])]),o("el-col",{attrs:{span:20}},[o("p",[e._v(e._s(e.qrcodeData.name))])])],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[e._v("实际内容")])]),o("el-col",{attrs:{span:20}},[o("p",[e._v(e._s(e.qrcodeData.text))])])],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[e._v("调用地址")])]),o("el-col",{attrs:{span:20}},[o("p",[e._v(e._s(e.qrcodeData.url))])])],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:e.handleCopy}},[e._v("复制调用地址")]),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogQrcodeVisible=!1}}},[e._v("确定")])],1)],1)],1)},n=[],i=(o("4160"),o("b0c0"),o("d3b7"),o("159b"),o("5530")),r=o("b85c"),l=o("f749"),s=o("60bb"),c=o("707d"),d=o("ca00"),u={components:{csUpload:function(){return o.e("chunk-0383e8e2").then(o.bind(null,"8422"))},csStorage:function(){return o.e("chunk-7557cd56").then(o.bind(null,"8704"))}},props:{loading:{default:!1},tableData:{default:function(){return[]}}},data:function(){return{qrcodeUrl:"",qrcodeImage:"",currentTableData:[],multipleSelection:[],auth:{add:!1,set:!1,del:!1,view:!1},dialogLoading:!1,dialogFormVisible:!1,dialogStatus:"",dialogQrcodeVisible:!1,qrcodeData:{name:"",text:"",url:""},textMap:{update:"编辑二维码",create:"新增二维码"},form:{name:void 0,text:void 0,size:void 0,logo:void 0},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{max:50,message:"长度不能大于 50 个字符",trigger:"blur"}],text:[{required:!0,message:"内容不能为空",trigger:"blur"},{max:255,message:"内容不能大于 255 个字符",trigger:"blur"}],logo:[{max:512,message:"长度不能大于 512 个字符",trigger:"blur"}],size:[{type:"number",message:"必须为数字值",trigger:"blur"}],suffix:[{required:!0,message:"至少选择一项",trigger:"change"}]}}},computed:{changeQrcode:function(){var e=this.form,t=e.text,o=e.size,a=e.logo,n=e.suffix;return{text:t,size:o,logo:a,suffix:n}}},watch:{tableData:{handler:function(e){this.currentTableData=e},immediate:!0},changeQrcode:{handler:function(){var e=this;this.$nextTick((function(){e._getQrcodeImage()}))}},dialogQrcodeVisible:{handler:function(e){!1===e&&(this.qrcodeData.url="")}}},mounted:function(){var e=this;this._validationAuth(),Object(l["c"])().then((function(t){e.qrcodeUrl=t.data.call_url}))},methods:{_validationAuth:function(){this.auth.add=this.$permission("/system/aided/qrcode/add"),this.auth.set=this.$permission("/system/aided/qrcode/set"),this.auth.del=this.$permission("/system/aided/qrcode/del"),this.auth.view=this.$permission("/system/aided/qrcode/view")},_getIdList:function(e){null===e&&(e=this.multipleSelection);var t=[];return Array.isArray(e)?e.forEach((function(e){t.push(e.qrcode_id)})):t.push(this.currentTableData[e].qrcode_id),t},handleCommand:function(e){switch(e){case"storage":this.$refs.storage.handleStorageDlg([0,2]);break;case"upload":this.$refs.upload.handleUploadDlg();break}},_getQrcodeImage:Object(s["debounce"])((function(){if(this.form.text){var e=this.form,t=e.text,o=e.size,a=e.logo,n=e.suffix;this.qrcodeImage=d["a"].getQrcodeUrl("",{text:t,size:o,logo:a,suffix:n})}}),500),_getUploadFileList:function(e){if(e.length){var t=e[0].response;t&&200===t.status&&0===t.data[0].type&&(this.form.logo=d["a"].checkUrl(t.data[0].url))}},_getStorageFileList:function(e){if(e.length){var t,o=Object(r["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(0===a.type){this.form.logo=d["a"].checkUrl(a.url);break}}}catch(n){o.e(n)}finally{o.f()}}},handleSelectionChange:function(e){this.multipleSelection=e},handleCreate:function(){var e=this;this.qrcodeImage="",this.form={name:"",text:"",size:75,logo:"",suffix:"png"},this.$nextTick((function(){e.$refs.form&&e.$refs.form.clearValidate(),e.dialogStatus="create",e.dialogLoading=!1,e.dialogFormVisible=!0}))},create:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.dialogLoading=!0,Object(l["a"])(e.form).then((function(t){e.currentTableData.unshift(t.data),e.dialogFormVisible=!1,e.$message.success("操作成功")})).catch((function(){e.dialogLoading=!1})))}))},handleDelete:function(e){var t=this,o=this._getIdList(e);0!==o.length?this.$confirm("确定要执行该操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then((function(){Object(l["b"])(o).then((function(){d["a"].deleteDataList(t.currentTableData,o,"qrcode_id"),t.currentTableData.length<=0&&t.$emit("refresh",!0),t.$message.success("操作成功")}))})).catch((function(){})):this.$message.error("请选择要操作的数据")},handleUpdate:function(e){var t=this;this.qrcodeImage="",this.currentIndex=e,this.form=Object(i["a"])({},this.currentTableData[e]),this.$nextTick((function(){t.$refs.form&&t.$refs.form.clearValidate(),t.dialogStatus="update",t.dialogLoading=!1,t.dialogFormVisible=!0}))},update:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.dialogLoading=!0,Object(l["e"])(e.form).then((function(t){e.$set(e.currentTableData,e.currentIndex,Object(i["a"])(Object(i["a"])({},e.currentTableData[e.currentIndex]),t.data)),e.dialogFormVisible=!1,e.$message.success("操作成功")})).catch((function(){e.dialogLoading=!1})))}))},handleView:function(e){var t=this.currentTableData[e];this.qrcodeData={name:t.name,text:t.text,url:this.qrcodeUrl+"&qrcode_id=".concat(t.qrcode_id)},this.dialogQrcodeVisible=!0},handleCopy:function(){var e=this;c["a"](this.qrcodeData.url).then((function(){e.$message.success("已复制调用地址到剪贴板")})).catch((function(t){e.$message.error(t)}))}}},f=u,p=(o("0aaa"),o("2877")),m=Object(p["a"])(f,a,n,!1,null,"41f0c018",null);t["default"]=m.exports}}]);